# iptables_log_hlpr
Tool for parsing `iptables` logs generated by the **LOG** target from the kernel logs. 

## Filters
Current implemented filters:
* Input
* Output
* Mac address
* Source address
* Destination address

In addition to the filters, the option to present the filtered result as number of entries and a max limit of entries can be used.

**Todo** filters:
* Destination port
* Source port
* Protocol
* Specific interface name

## Prerequisites
* In order to use iptables **LOG** target, `CONFIG_NETFILTER_XT_TARGET_LOG` needs to be enabled in the kernel. 
* Iptables rules added to a chain which actually generates log output 
* The tool expects a plain kernel log `$ dmesg > logfile.txt`

## Usage
Usage of the tool:
```bash
python3 iptables_log_hlpr -f <logfile> <options>
```
Examples:
```bash
# Filter on input traffic only
$ python3 iptables_log_hlpr -f kernel_log_file.txt -i

# Number of entries matching for output traffic only, with specific destination address
$ python3 iptables_log_hlpr -f kernel_log_file.txt -o -d "198.20.60.301" -n 

# Help
$ python3 iptables_log_hlpr --help
```
